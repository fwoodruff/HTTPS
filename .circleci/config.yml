version: 2.1
# circleci local execute --config ./.circleci/config.yml test
jobs:
  test:
    docker:
      - image: cimg/base:2024.07
    steps:
      - checkout
      - run:
          name: Install dependencies
          command: |
            sudo apt-get update
            sudo apt-get install -y g++-12 make
      - run:
          name: Build server
          command: make -j8
      - run:
          name: Run server
          command: |
            ./target/codeymccodeface
          background: true
      - run:
          name: Test server
          command: curl --insecure https://localhost

workflows:
  run_tests:
    jobs:
      - test
